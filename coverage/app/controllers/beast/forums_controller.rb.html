<html>
  <head>
    <title>app/controllers/beast/forums_controller.rb</title>
    
    <link href="../../../report.css?0.4880127675397222" media="screen" rel="stylesheet" type="text/css" />
    <script src='../../../jquery.js?0.8720457575146081'></script>
    <script>
      $(function() {

        $('#toggle_test_file').click(function(e) {
          e.preventDefault();
          if ($('#main_file').hasClass('side_by_side')) {
            $('#main_file').removeClass('side_by_side');
          } else {
            $('#main_file').addClass('side_by_side');
          }
        
          $('#test_file').toggle();
        });

        $('#test_file').hide();
        
        function cleanString(str) {
          return $.trim(str.replace(/<[^(<|>)]+>/gi, ''));
        }
        
        $('.line_number').hover(function() {
          $(this).attr('title', 'Line: ' + cleanString($(this).html()));
        });
        
        $('.hit_number').hover(function() {
          $(this).attr('title', 'Execution Count: ' + cleanString($(this).html()));
        });
        
        $('.code_line').hover(function() {
          $(this).attr('title', cleanString($(this).html()));
        });
        
      });
    </script>
  </head>
  <body>
    <h1><a href="../../../index.html">Coverage Report</a></h1>
    
    <table cellpadding='0' cellspacing='1'>
      <tr class='header'>
        <th>File</th>
        <th>Lines</th>
        <th>Lines Of Code</th>
        <th>Tested %</th>
      </tr>
      <tr valign='top'>
        <td>
          app/controllers/beast/forums_controller.rb
          
        </td>
        <td>87</td>
        <td>52</td>
        <td>98.1%</td>
      </tr>
    </table>

    <div>&nbsp;</div>
    
    <table cellpadding='0' cellspacing='1'>
      <tr>
        <th>Legend</th>
      </tr>
      <tr>
        <td class='hit'>This line was executed.</td>
      </tr>
      <tr>
        <td class='miss'>This line was not executed!</td>
      </tr>
      <tr>
        <td class='never'>This line doesn't matter.</td>
      </tr>
    </table>
    
    <div>&nbsp;</div>

    <div id='content'>
      <div id='main_file'>
        <table id='main'>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>1</td>
              <td class='code_line'>
                <pre>class Beast::ForumsController < BeastController</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>2</td>
              <td class='code_line'>
                <pre>  skip_filter :login_required</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>3</td>
              <td class='code_line'>
                <pre>  before_filter :find_group_and_user</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>4</td>
              <td class='code_line'>
                <pre>  before_filter :find_forums, :only => [:edit, :update, :new]</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>5</td>
              <td class='code_line'>
                <pre>  before_filter :login_required</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>6</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>7</td>
              <td class='code_line'>
                <pre>  cache_sweeper :posts_sweeper, :only => [:create, :update, :destroy]</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>8</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>9</td>
              <td class='code_line'>
                <pre>  def index</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>10</td>
              <td class='code_line'>
                <pre>    if @discussable</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>11</td>
              <td class='code_line'>
                <pre>      @forums = @discussable.forums.includes(:posts)</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>12</td>
              <td class='code_line'>
                <pre>      @voices = @forums.map(&:user_ids).flatten.uniq.length</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>13</td>
              <td class='code_line'>
                <pre>    else</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>14</td>
              <td class='code_line'>
                <pre>      @school = School.find(@school.id) #most actions don't require anything besides school_id</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>15</td>
              <td class='code_line'>
                <pre>      render :action => "personal"</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>16</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>17</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>18</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>19</td>
              <td class='code_line'>
                <pre>  def show</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>20</td>
              <td class='code_line'>
                <pre>    @forum = @discussable.forums.find(params[:id], :include => :moderators)</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>21</td>
              <td class='code_line'>
                <pre>    # keep track of when we last viewed this forum for activity </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>22</td>
              <td class='code_line'>
                <pre>    (session[:forums] ||= {})[@forum.id] = Time.now.utc if logged_in?</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>23</td>
              <td class='code_line'>
                <pre>    @topics = Topic.paginate_for_forum(@forum, params[:page])</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>24</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>25</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>26</td>
              <td class='code_line'>
                <pre>  def new</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>27</td>
              <td class='code_line'>
                <pre>    @positions = @forums.collect(&:position)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>28</td>
              <td class='code_line'>
                <pre>    @positions.push((@positions.max || 0)+ 1)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>29</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>30</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>31</td>
              <td class='code_line'>
                <pre>  def create</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>32</td>
              <td class='code_line'>
                <pre>    @forum = current_user.owned_forums.create(params[:forum].merge({:discussable_type => @discussable.klass, :discussable_id => @discussable.id}))</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>33</td>
              <td class='code_line'>
                <pre>    if @forum.valid? </pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>34</td>
              <td class='code_line'>
                <pre>      @forum.insert_at(params[:forum][:position]) if params[:forum][:position] != @forum.position.to_s</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>35</td>
              <td class='code_line'>
                <pre>      redirect_to forums_path(@discussable), :notice => msg</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>36</td>
              <td class='code_line'>
                <pre>    else</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>37</td>
              <td class='code_line'>
                <pre>      @forums = @discussable.forums</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>38</td>
              <td class='code_line'>
                <pre>      render "new" </pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>39</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>40</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>41</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>42</td>
              <td class='code_line'>
                <pre>  def edit</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>43</td>
              <td class='code_line'>
                <pre>    @positions = @forums.collect(&:position)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>44</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>45</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>46</td>
              <td class='code_line'>
                <pre>  def update</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>47</td>
              <td class='code_line'>
                <pre>    @forum.update_attributes!(params[:forum].except(:position))</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>48</td>
              <td class='code_line'>
                <pre>    @forum.insert_at(params[:forum][:position].to_i) unless @forum.position == params[:forum][:position].to_i</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>49</td>
              <td class='code_line'>
                <pre>    redirect_to forums_path(@discussable) </pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>50</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>51</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>52</td>
              <td class='code_line'>
                <pre>  def destroy</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>53</td>
              <td class='code_line'>
                <pre>    @forum = @discussable.forums.find(params[:id])</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>54</td>
              <td class='code_line'>
                <pre>    @forum.destroy</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>55</td>
              <td class='code_line'>
                <pre>    respond_to do |format|</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>56</td>
              <td class='code_line'>
                <pre>      format.html { redirect_to forums_path(@discussable), :notice => msg }</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>57</td>
              <td class='code_line'>
                <pre>      format.js {render :update do |page| page.redirect_to forums_path(@discussable, :notice => msg) end }</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>58</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>59</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>60</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>61</td>
              <td class='code_line'>
                <pre>  protected</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>62</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>63</td>
              <td class='code_line'>
                <pre>    def find_group_and_user</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>64</td>
              <td class='code_line'>
                <pre>      @user = (params[:user_id] && !(current_user.is_a?Student))? @school.students.find(params[:user_id]) : current_user</pre>
              </td>
              <td class='hit_number'>45</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>65</td>
              <td class='code_line'>
                <pre>      @sections = @user.sections.sort_by(&:time) if (@user.is_a?(Student) || @user.is_a?(Teacher))</pre>
              </td>
              <td class='hit_number'>45</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>66</td>
              <td class='code_line'>
                <pre>      @sections = @student.sections.sort_by(&:time) if @user.is_a?(Parent)</pre>
              </td>
              <td class='hit_number'>45</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>67</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>68</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>69</td>
              <td class='code_line'>
                <pre>    def find_forums</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>70</td>
              <td class='code_line'>
                <pre>      @forums = @discussable.forums</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>71</td>
              <td class='code_line'>
                <pre>      @forum = params[:id] ? @discussable.forums.detect{|f| f.id == params[:id].to_i} : Forum.new</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>72</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>73</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>74</td>
              <td class='code_line'>
                <pre>  def authorized?</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>75</td>
              <td class='code_line'>
                <pre>    session[:forums] ||= {}</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>76</td>
              <td class='code_line'>
                <pre>    case action_name</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>77</td>
              <td class='code_line'>
                <pre>    when 'edit', 'update', 'destroy'</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>78</td>
              <td class='code_line'>
                <pre>      current_user.owns?(@forum)</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>79</td>
              <td class='code_line'>
                <pre>    when 'new', 'create'</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>80</td>
              <td class='code_line'>
                <pre>      current_user.may_create_forum_for?(@discussable)</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>81</td>
              <td class='code_line'>
                <pre>    when 'index', 'show'</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>82</td>
              <td class='code_line'>
                <pre>      @discussable.nil? || current_user.may_access_forum_for?(@discussable)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>83</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>84</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>85</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>86</td>
              <td class='code_line'>
                <pre>end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>87</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
        </table>
      </div>
      
    </div>
    
    <p>Generated on: 2011-02-26 21:12:41 -0500</p>
  </body>
</html>