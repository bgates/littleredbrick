<html>
  <head>
    <title>app/models/post.rb</title>
    
    <link href="../../report.css?0.21208032491547846" media="screen" rel="stylesheet" type="text/css" />
    <script src='../../jquery.js?0.23367116539642774'></script>
    <script>
      $(function() {

        $('#toggle_test_file').click(function(e) {
          e.preventDefault();
          if ($('#main_file').hasClass('side_by_side')) {
            $('#main_file').removeClass('side_by_side');
          } else {
            $('#main_file').addClass('side_by_side');
          }
        
          $('#test_file').toggle();
        });

        $('#test_file').hide();
        
        function cleanString(str) {
          return $.trim(str.replace(/<[^(<|>)]+>/gi, ''));
        }
        
        $('.line_number').hover(function() {
          $(this).attr('title', 'Line: ' + cleanString($(this).html()));
        });
        
        $('.hit_number').hover(function() {
          $(this).attr('title', 'Execution Count: ' + cleanString($(this).html()));
        });
        
        $('.code_line').hover(function() {
          $(this).attr('title', cleanString($(this).html()));
        });
        
      });
    </script>
  </head>
  <body>
    <h1><a href="../../index.html">Coverage Report</a></h1>
    
    <table cellpadding='0' cellspacing='1'>
      <tr class='header'>
        <th>File</th>
        <th>Lines</th>
        <th>Lines Of Code</th>
        <th>Tested %</th>
      </tr>
      <tr valign='top'>
        <td>
          app/models/post.rb
          
        </td>
        <td>127</td>
        <td>76</td>
        <td>97.4%</td>
      </tr>
    </table>

    <div>&nbsp;</div>
    
    <table cellpadding='0' cellspacing='1'>
      <tr>
        <th>Legend</th>
      </tr>
      <tr>
        <td class='hit'>This line was executed.</td>
      </tr>
      <tr>
        <td class='miss'>This line was not executed!</td>
      </tr>
      <tr>
        <td class='never'>This line doesn't matter.</td>
      </tr>
    </table>
    
    <div>&nbsp;</div>

    <div id='content'>
      <div id='main_file'>
        <table id='main'>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>1</td>
              <td class='code_line'>
                <pre>class Post < ActiveRecord::Base</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>2</td>
              <td class='code_line'>
                <pre>  def self.per_page() 25 end</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>3</td>
              <td class='code_line'>
                <pre>#TODO: index by user/created_at</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>4</td>
              <td class='code_line'>
                <pre>  belongs_to :discussable, :polymorphic => true</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>5</td>
              <td class='code_line'>
                <pre>  belongs_to :forum</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>6</td>
              <td class='code_line'>
                <pre>  belongs_to :forum_activity</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>7</td>
              <td class='code_line'>
                <pre>  belongs_to :topic</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>8</td>
              <td class='code_line'>
                <pre>  belongs_to :user</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>9</td>
              <td class='code_line'>
                <pre>  before_save :remove_obscenities</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>10</td>
              <td class='code_line'>
                <pre>  format_attribute :body #TODO: does format_attribute still work?</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>11</td>
              <td class='code_line'>
                <pre>  before_create { |r| r.forum_id = r.topic.forum_id }</pre>
              </td>
              <td class='hit_number'>42</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>12</td>
              <td class='code_line'>
                <pre>  after_create  :update_cached_fields, :set_activity</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>13</td>
              <td class='code_line'>
                <pre>  after_destroy :update_cached_fields, :set_activity</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>14</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>15</td>
              <td class='code_line'>
                <pre>  validate :check_html, :topic_unlocked?</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>16</td>
              <td class='code_line'>
                <pre>  validates_presence_of :user_id, :body</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>17</td>
              <td class='code_line'>
                <pre>  attr_accessible :body</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>18</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>19</td>
              <td class='code_line'>
                <pre>  @@query_options = {</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>20</td>
              <td class='code_line'>
                <pre>    :per_page => 25,</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>21</td>
              <td class='code_line'>
                <pre>    :select => "posts.*, topics.title as topic_title, forums.name as forum_name",</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>22</td>
              <td class='code_line'>
                <pre>    :joins => "inner join topics on posts.topic_id = topics.id inner join forums on topics.forum_id = forums.id",</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>23</td>
              <td class='code_line'>
                <pre>    :order => "posts.created_at desc"</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>24</td>
              <td class='code_line'>
                <pre>  }</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>25</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>26</td>
              <td class='code_line'>
                <pre>  def date</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>27</td>
              <td class='code_line'>
                <pre>    updated_at.strftime("%a %b %d")</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>28</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>29</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>30</td>
              <td class='code_line'>
                <pre>  def editable_by?(user)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>31</td>
              <td class='code_line'>
                <pre>    user.id == user_id || user.moderator_of?(topic.forum_id)</pre>
              </td>
              <td class='hit_number'>267</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>32</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>33</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>34</td>
              <td class='code_line'>
                <pre>  def self.count_for_user(user)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>35</td>
              <td class='code_line'>
                <pre>    where(['user_id = ?', user.id]).count('id')</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>36</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>37</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>38</td>
              <td class='code_line'>
                <pre>  def self.of_interest_to(user)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>39</td>
              <td class='code_line'>
                <pre>    where(["((posts.discussable_type = 'Section' AND posts.discussable_id IN (?)) OR (posts.discussable_type IN (?) AND posts.discussable_id = ?)) AND posts.created_at > ?", user.section_ids, user.discussables, user.school_id, Date.today - 7]).includes([:topic, :forum, :user]).group_by(&:topic_id).collect{|topic, posts| posts.max{|a, b| a.created_at <=> b.created_at }}</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>40</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>41</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>42</td>
              <td class='code_line'>
                <pre>  def self.monitored(reader_id, page)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>43</td>
              <td class='code_line'>
                <pre>    conditions = ["monitorships.user_id = ? and posts.user_id != ? and monitorships.active = ?", reader_id, reader_id, true]</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>44</td>
              <td class='code_line'>
                <pre>    options = @@query_options.merge(:conditions => conditions, :page => page, :count => { :select => 'posts.id' })</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>45</td>
              <td class='code_line'>
                <pre>    options[:joins] += " inner join monitorships on monitorships.topic_id = topics.id"</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>46</td>
              <td class='code_line'>
                <pre>    paginate options</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>47</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>48</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>49</td>
              <td class='code_line'>
                <pre>  def self.paginate_for_topic(id, page, discussable)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="miss" data-hits='#{cov}'"">
              <td class='line_number'>50</td>
              <td class='code_line'>
                <pre>    scoped_by_topic_id(id).paginate :include => [{:user => [:forum_activities, :moderatorships]}], :order => "posts.created_at", :per_page => 25, :page => page, :conditions => ['posts.discussable_type = :type AND posts.discussable_id = :id AND forum_activities.discussable_type = :type AND forum_activities.discussable_id = :id', {:type => discussable.klass, :id => discussable.id}]</pre>
              </td>
              <td class='hit_number'>0</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>51</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>52</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>53</td>
              <td class='code_line'>
                <pre>  def self.recent(n = 5, discussable = nil)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>54</td>
              <td class='code_line'>
                <pre>    result = select("posts.*, users.*, topics.title as topic_title, forums.name as forum_name").joins("inner join users on posts.user_id = users.id inner join topics on posts.topic_id = topics.id inner join forums on topics.forum_id = forums.id").order("posts.created_at desc").limit(n)</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>55</td>
              <td class='code_line'>
                <pre>    if discussable</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>56</td>
              <td class='code_line'>
                <pre>      result = result.where(['posts.discussable_id = ? AND posts.discussable_type = ?', discussable.id, discussable.klass]) </pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>57</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>58</td>
              <td class='code_line'>
                <pre>    result</pre>
              </td>
              <td class='hit_number'>9</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>59</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>60</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>61</td>
              <td class='code_line'>
                <pre>  def self.recent_by_user</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>62</td>
              <td class='code_line'>
                <pre>    where(['updated_at > ?', 1.hour.ago]).select('user_id').group('user_id').count</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>63</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>64</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>65</td>
              <td class='code_line'>
                <pre>  def self.restrict_by(params)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>66</td>
              <td class='code_line'>
                <pre>    restricted = self</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>67</td>
              <td class='code_line'>
                <pre>    params[:user_id] = params[:reader_id]</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>68</td>
              <td class='code_line'>
                <pre>    [:forum_id, :topic_id, :user_id].each do |attr|</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>69</td>
              <td class='code_line'>
                <pre>      if params[attr]</pre>
              </td>
              <td class='hit_number'>117</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>70</td>
              <td class='code_line'>
                <pre>        restricted = restricted.where(["posts.#{attr} = ?", params[attr]])</pre>
              </td>
              <td class='hit_number'>18</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>71</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>72</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>73</td>
              <td class='code_line'>
                <pre>    options = @@query_options.merge(:page => params[:page])</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>74</td>
              <td class='code_line'>
                <pre>    restricted.paginate options</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>75</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>76</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>77</td>
              <td class='code_line'>
                <pre>  def self.search(term, page)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>78</td>
              <td class='code_line'>
                <pre>    options = @@query_options.merge(:page => page)</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>79</td>
              <td class='code_line'>
                <pre>    where(["LOWER(posts.body) LIKE ?", "%#{term}%"]).paginate options</pre>
              </td>
              <td class='hit_number'>6</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>80</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>81</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>82</td>
              <td class='code_line'>
                <pre>  def set_restricted_values(user, discussable)</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>83</td>
              <td class='code_line'>
                <pre>    self.user, self.discussable_id, self.discussable_type = user, discussable.id, discussable.klass</pre>
              </td>
              <td class='hit_number'>39</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>84</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>85</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>86</td>
              <td class='code_line'>
                <pre>  def to_xml(options = {})</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>87</td>
              <td class='code_line'>
                <pre>    options[:except] ||= []</pre>
              </td>
              <td class='hit_number'>60</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>88</td>
              <td class='code_line'>
                <pre>    options[:except] << :topic_title << :forum_name</pre>
              </td>
              <td class='hit_number'>60</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>89</td>
              <td class='code_line'>
                <pre>    super</pre>
              </td>
              <td class='hit_number'>60</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>90</td>
              <td class='code_line'>
                <pre>  end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>91</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>92</td>
              <td class='code_line'>
                <pre>  protected</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>93</td>
              <td class='code_line'>
                <pre>    # using count isn't ideal but it gives us correct caches each time</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>94</td>
              <td class='code_line'>
                <pre>    def update_cached_fields</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>95</td>
              <td class='code_line'>
                <pre>      Forum.update_all ['posts_count = ?', Post.count(:id, :conditions => {:forum_id => forum_id})], ['id = ?', forum_id]</pre>
              </td>
              <td class='hit_number'>72</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>96</td>
              <td class='code_line'>
                <pre>      topic.update_cached_post_fields(self)</pre>
              </td>
              <td class='hit_number'>72</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>97</td>
              <td class='code_line'>
                <pre>      if discussable_type == 'Section'</pre>
              </td>
              <td class='hit_number'>72</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>98</td>
              <td class='code_line'>
                <pre>        s = Section.find(discussable_id)</pre>
              </td>
              <td class='hit_number'>60</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>99</td>
              <td class='code_line'>
                <pre>        frozen??  s.decrement!(:posts_count) : s.increment!(:posts_count)</pre>
              </td>
              <td class='hit_number'>60</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>100</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>101</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>102</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>103</td>
              <td class='code_line'>
                <pre>    def set_activity</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>104</td>
              <td class='code_line'>
                <pre>      activity = ForumActivity.find_or_create(user_id, discussable_type, discussable_id)</pre>
              </td>
              <td class='hit_number'>72</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>105</td>
              <td class='code_line'>
                <pre>      frozen??  activity.decrement!(:posts_count) : activity.increment!(:posts_count)</pre>
              </td>
              <td class='hit_number'>72</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>106</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>107</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>108</td>
              <td class='code_line'>
                <pre>    def remove_obscenities</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>109</td>
              <td class='code_line'>
                <pre>      self.body = smurf_text(body)</pre>
              </td>
              <td class='hit_number'>45</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>110</td>
              <td class='code_line'>
                <pre>      self.body_html = smurf_text(body_html)</pre>
              </td>
              <td class='hit_number'>45</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>111</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>112</td>
              <td class='code_line'>
                <pre>    </pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>113</td>
              <td class='code_line'>
                <pre>    def check_html</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>114</td>
              <td class='code_line'>
                <pre>      begin</pre>
              </td>
              <td class='hit_number'>114</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>115</td>
              <td class='code_line'>
                <pre>        REXML::Document.new("<tag>#{self.body_html}</tag>") </pre>
              </td>
              <td class='hit_number'>114</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>116</td>
              <td class='code_line'>
                <pre>        #<tag> is used bc xml doc must have one enclosing tag</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>117</td>
              <td class='code_line'>
                <pre>      rescue REXML::ParseException => exception</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>118</td>
              <td class='code_line'>
                <pre>        errors.add(:body, 'is not valid HTML.')</pre>
              </td>
              <td class='hit_number'>3</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>119</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>120</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>121</td>
              <td class='code_line'>
                <pre></pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>122</td>
              <td class='code_line'>
                <pre>    def topic_unlocked?</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>123</td>
              <td class='code_line'>
                <pre>      if topic && topic.locked? </pre>
              </td>
              <td class='hit_number'>114</td>
            </tr>
          
            <tr class="hit" data-hits='#{cov}'"">
              <td class='line_number'>124</td>
              <td class='code_line'>
                <pre>        errors.add(:base, 'This topic is locked, so no posts may be added.')</pre>
              </td>
              <td class='hit_number'>12</td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>125</td>
              <td class='code_line'>
                <pre>      end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>126</td>
              <td class='code_line'>
                <pre>    end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
            <tr class="never" "">
              <td class='line_number'>127</td>
              <td class='code_line'>
                <pre>end</pre>
              </td>
              <td class='hit_number'></td>
            </tr>
          
        </table>
      </div>
      
    </div>
    
    <p>Generated on: 2011-02-26 21:12:41 -0500</p>
  </body>
</html>